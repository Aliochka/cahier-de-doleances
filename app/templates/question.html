{% extends "base.html" %}
{% block title %}Question · Exploration · Grand Débat{% endblock %}

{% block content %}
<section aria-labelledby="q-title" class="mb-6">
  <div class="font-[IBM_Plex_Mono] text-xs tracking-[0.06em] text-[#1F3A5F] dark:text-[#8AB6FF]">
    {{ question.form_name }}{% if question.section %} · {{ question.section }}{% endif %} · {{ question.question_code }}
  </div>
  <h1 id="q-title" class="mt-1 font-inter text-xl md:text-2xl leading-8">
    {{ question.prompt }}
  </h1>
</section>

<!-- Barre de recherche locale (dans les réponses de CETTE question) -->
<form class="relative"
      role="search"
      aria-label="Recherche dans les réponses"
      hx-get="{{ url_for('question_answers_partial', question_id=question.id) }}"
      hx-target="#answers"
      hx-push-url="true"
      hx-trigger="keyup changed delay:450ms from:#q, submit">
  <label for="q" class="sr-only">Rechercher dans les réponses</label>
  <input id="q" name="q" type="search" value="{{ q|default('') }}"
         placeholder="Chercher dans les réponses…"
         class="w-full rounded-xl border border-[#E7E2DA] dark:border-[#242938]
                bg-[#FFFAF2] dark:bg-[#0E1013] px-4 py-3 font-inter
                focus:outline-none focus:ring-2 focus:ring-offset-2
                focus:ring-[#1F3A5F] dark:focus:ring-[#8AB6FF] dark:focus:ring-offset-[#0E1013]" />
  <input type="hidden" name="page" value="{{ page|default(1) }}">
</form>

<section id="answers"
         class="mt-6"
         aria-live="polite"
         {% if page or q %}
           hx-get="{{ url_for('question_answers_partial', question_id=question.id) }}?page={{ page|default(1) }}{% if q %}&q={{ q|urlencode }}{% endif %}"
           hx-trigger="load"
           hx-target="#answers"
           hx-swap="innerHTML"
         {% endif %}>
  <p class="text-sm text-[#57534E] dark:text-[#B5B8BE]">Chargement…</p>
</section>
{% endblock %}
