{% extends "base.html" %}

{% block title %}Recherche par questions · Exploration · Grand Débat{% endblock %}

{% block content %}
<section aria-labelledby="titre-search-q" class="mb-6">
  <h1 id="titre-search-q"
      class="font-[IBM_Plex_Mono] text-2xl md:text-3xl tracking-[0.02em] text-[#1F3A5F] dark:text-[#8AB6FF]">
    Rechercher par question
  </h1>
  <p class="mt-2 text-[16px] md:text-[17px] leading-7 font-inter">
    Tape un mot‑clé pour trouver les questions officielles. Chaque carte affiche
    <strong>3 réponses au hasard</strong> pour donner un aperçu.
  </p>
</section>

<form class="relative" role="search" aria-label="Recherche de questions"
      hx-get="{{ url_for('partials_search_questions') }}"
      hx-target="#results"
      hx-push-url="true"
      hx-trigger="keyup changed delay:400ms from:#q, submit">
  <label for="q" class="sr-only">Rechercher</label>
  <input id="q" name="q" type="search" value="{{ q }}"
         placeholder="Ex. impôts, transports, environnement…"
         class="w-full rounded-xl border border-[#E7E2DA] dark:border-[#242938]
                bg-[#FFFAF2] dark:bg-[#0E1013] px-4 py-3 font-inter
                focus:outline-none focus:ring-2 focus:ring-offset-2
                focus:ring-[#1F3A5F] dark:focus:ring-[#8AB6FF] dark:focus:ring-offset-[#0E1013]" />
  <input type="hidden" name="page" value="{{ page|default(1) }}">
</form>

<section id="results"
         class="mt-6"
         aria-live="polite"
         {% if q %}
           hx-get="{{ url_for('partials_search_questions') }}?q={{ q|urlencode }}&page={{ page|default(1) }}"
           hx-trigger="load"
           hx-target="#results"
           hx-swap="innerHTML"
         {% endif %}>
  {% if not q %}
    <p class="text-sm text-[#57534E] dark:text-[#B5B8BE]">Tape un mot‑clé pour commencer.</p>
  {% else %}
    <p class="text-sm text-[#57534E] dark:text-[#B5B8BE]">Chargement…</p>
  {% endif %}
</section>
{% endblock %}
