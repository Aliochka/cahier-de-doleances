{# app/templates/questions/_card.html #}
<article class="question-card">
  {# Titre affiché avec highlight si présent #}
  {% set title_html =
       (q.prompt_hl|safe) if q.prompt_hl is defined and q.prompt_hl
       else (q.title if q.title is defined and q.title
       else q.prompt) %}

  {# URL canonique avec slug, fallback legacy si slug absent #}
  {% if q.slug is defined and q.slug %}
    {% set q_url = url_for('question_detail', question_id=q.id, slug=q.slug) %}
  {% else %}
    {% set q_url = url_for('question_detail_legacy', question_id=q.id) %}
  {% endif %}

  <h3 class="h3 question-card__title">
    <a href="{{ q_url }}">{{ title_html }}</a>
    {% if q.answers_count is defined and q.answers_count == 0 %}
      <span class="badge badge--muted">0&nbsp;réponse</span>
    {% endif %}
  </h3>
</article>
